<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhishGuard - URL Security Scanner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            max-width: 900px;
            width: 100%;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            min-height: 600px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo {
            font-size: 2.5em;
            font-weight: bold;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
        }

        /* Navigation */
        .nav {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 50px;
            padding: 5px;
        }

        .nav-btn {
            background: none;
            border: none;
            padding: 12px 25px;
            margin: 0 5px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .nav-btn.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .nav-btn:hover:not(.active) {
            background: rgba(102, 126, 234, 0.2);
        }

        /* Page sections */
        .page {
            display: none;
        }

        .page.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Scanner page styles */
        .input-section {
            margin-bottom: 30px;
        }

        .input-group {
            position: relative;
            margin-bottom: 20px;
        }

        #urlInput {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 50px;
            font-size: 16px;
            transition: all 0.3s ease;
            outline: none;
        }

        #urlInput:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .scan-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .scan-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .scan-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .results {
            margin-top: 30px;
            padding: 20px;
            border-radius: 15px;
            display: none;
        }

        .results.safe {
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
            border-left: 5px solid #4caf50;
        }

        .results.warning {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            border-left: 5px solid #ff9800;
        }

        .results.danger {
            background: linear-gradient(135deg, #fd79a8 0%, #fdcb6e 100%);
            border-left: 5px solid #f44336;
        }

        .risk-score {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .risk-level {
            font-size: 1.2em;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .indicators {
            margin-top: 20px;
        }

        .indicator {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 8px;
        }

        .indicator-icon {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            font-weight: bold;
        }

        .safe-icon { color: #4caf50; }
        .warning-icon { color: #ff9800; }
        .danger-icon { color: #f44336; }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Skeleton Loading Styles */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 8px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .skeleton-results {
            margin-top: 30px;
            padding: 20px;
            border-radius: 15px;
            background: rgba(240, 240, 240, 0.3);
            border-left: 5px solid #e0e0e0;
            display: none;
        }

        .skeleton-score {
            height: 40px;
            width: 200px;
            margin-bottom: 15px;
        }

        .skeleton-level {
            height: 25px;
            width: 150px;
            margin-bottom: 20px;
        }

        .skeleton-indicator {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 8px;
        }

        .skeleton-icon {
            width: 20px;
            height: 20px;
            margin-right: 15px;
            border-radius: 50%;
        }

        .skeleton-text {
            height: 16px;
            flex: 1;
        }

        .skeleton-text.short {
            width: 60%;
        }

        .skeleton-text.medium {
            width: 80%;
        }

        .skeleton-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .skeleton-stat-card {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 12px;
            border-left: 4px solid #e0e0e0;
        }

        .skeleton-stat-number {
            height: 40px;
            width: 60px;
            margin: 0 auto 10px;
            border-radius: 4px;
        }

        .skeleton-stat-label {
            height: 16px;
            width: 80px;
            margin: 0 auto;
        }

        .skeleton-history {
            background: rgba(240, 240, 240, 0.1);
            border-radius: 15px;
            padding: 25px;
        }

        .skeleton-history-title {
            height: 28px;
            width: 150px;
            margin-bottom: 20px;
        }

        .skeleton-history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 12px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            border-left: 4px solid #e0e0e0;
        }

        .skeleton-history-url {
            height: 18px;
            flex: 1;
            margin-right: 15px;
        }

        .skeleton-history-badge {
            height: 24px;
            width: 60px;
            border-radius: 12px;
            margin-right: 15px;
        }

        .skeleton-history-date {
            height: 14px;
            width: 80px;
        }

        .info-section {
            margin-top: 40px;
            padding: 20px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 15px;
        }

        .info-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }

        .info-list {
            list-style: none;
        }

        .info-list li {
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .info-list li:before {
            content: "🔍";
            position: absolute;
            left: 0;
        }

        /* About page styles */
        .about-content {
            line-height: 1.6;
        }

        .about-section {
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .section-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.7);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .feature-card h4 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        /* Profile page styles */
        .profile-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 15px;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 2em;
            color: white;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .history-section {
            background: rgba(102, 126, 234, 0.1);
            border-radius: 15px;
            padding: 25px;
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .history-url {
            font-weight: 500;
            color: #333;
            flex: 1;
            margin-right: 15px;
            word-break: break-all;
        }

        .history-risk {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            text-transform: uppercase;
        }

        .history-risk.low { background: #4caf50; color: white; }
        .history-risk.medium { background: #ff9800; color: white; }
        .history-risk.high { background: #f44336; color: white; }

        .history-date {
            font-size: 0.8em;
            color: #666;
            margin-left: 15px;
        }

        .clear-history-btn {
            background: linear-gradient(45deg, #f44336, #e57373);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .clear-history-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(244, 67, 54, 0.3);
        }

        .empty-history {
            text-align: center;
            color: #666;
            padding: 40px;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">🛡️ PhishGuard</div>
            <div class="subtitle">Advanced URL Phishing Detection & Security Scanner</div>
        </div>

        <nav class="nav">
            <button class="nav-btn active" onclick="showPage('scanner')">Scanner</button>
            <button class="nav-btn" onclick="showPage('about')">About</button>
            <button class="nav-btn" onclick="showPage('profile')">Profile</button>
        </nav>

        <!-- Scanner Page -->
        <div id="scanner" class="page active">
            <div class="input-section">
                <div class="input-group">
                    <input type="url" id="urlInput" placeholder="Enter URL to scan (e.g., https://example.com)" />
                </div>
                <button class="scan-btn" onclick="scanUrl()">Scan for Threats</button>
            </div>

            <div id="loading" class="loading" style="display: none;">
                <div class="spinner"></div>
                <span style="margin-left: 15px;">Analyzing URL security...</span>
            </div>

            <!-- Skeleton Loading for Results -->
            <div id="skeletonResults" class="skeleton-results">
                <div class="skeleton skeleton-score"></div>
                <div class="skeleton skeleton-level"></div>
                <div class="skeleton-indicator">
                    <div class="skeleton skeleton-icon"></div>
                    <div class="skeleton skeleton-text"></div>
                </div>
                <div class="skeleton-indicator">
                    <div class="skeleton skeleton-icon"></div>
                    <div class="skeleton skeleton-text short"></div>
                </div>
                <div class="skeleton-indicator">
                    <div class="skeleton skeleton-icon"></div>
                    <div class="skeleton skeleton-text medium"></div>
                </div>
                <div class="skeleton-indicator">
                    <div class="skeleton skeleton-icon"></div>
                    <div class="skeleton skeleton-text"></div>
                </div>
            </div>

            <div id="results" class="results">
                <div class="risk-score" id="riskScore"></div>
                <div class="risk-level" id="riskLevel"></div>
                <div class="indicators" id="indicators"></div>
            </div>

            <div class="info-section">
                <div class="info-title">What We Check For:</div>
                <ul class="info-list">
                    <li>Suspicious domain patterns and typosquatting</li>
                    <li>URL shorteners and redirects</li>
                    <li>Unusual TLD (top-level domains)</li>
                    <li>Suspicious keywords and patterns</li>
                    <li>Domain age and reputation indicators</li>
                    <li>HTTPS security implementation</li>
                    <li>Homograph attacks and character substitution</li>
                </ul>
            </div>
        </div>

        <!-- About Page -->
        <div id="about" class="page">
            <div class="about-content">
                <div class="about-section">
                    <div class="section-title">
                        🔍 How PhishGuard Works
                    </div>
                    <p>PhishGuard employs advanced pattern recognition and heuristic analysis to identify potentially malicious URLs. Our system analyzes multiple aspects of a URL to provide a comprehensive security assessment in real-time.</p>
                </div>

                <div class="about-section">
                    <div class="section-title">
                        ⚙️ Detection Mechanisms
                    </div>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>🌐 Domain Analysis</h4>
                            <p>Examines domain structure, age, and reputation to identify suspicious patterns and newly registered domains.</p>
                        </div>
                        <div class="feature-card">
                            <h4>🔒 Security Protocol Check</h4>
                            <p>Verifies HTTPS implementation and SSL certificate validity to ensure secure connections.</p>
                        </div>
                        <div class="feature-card">
                            <h4>🎭 Homograph Detection</h4>
                            <p>Identifies character substitution attacks using similar-looking characters from different alphabets.</p>
                        </div>
                        <div class="feature-card">
                            <h4>📝 Keyword Analysis</h4>
                            <p>Scans for suspicious keywords commonly used in phishing attempts like "verify", "urgent", "suspended".</p>
                        </div>
                        <div class="feature-card">
                            <h4>🔗 URL Pattern Recognition</h4>
                            <p>Analyzes URL structure for suspicious patterns, excessive subdomains, and encoding anomalies.</p>
                        </div>
                        <div class="feature-card">
                            <h4>🏷️ TLD Reputation</h4>
                            <p>Evaluates top-level domains for known associations with malicious activities.</p>
                        </div>
                    </div>
                </div>

                <div class="about-section">
                    <div class="section-title">
                        📊 Risk Scoring System
                    </div>
                    <p>Our proprietary risk scoring algorithm assigns weighted values to different threat indicators:</p>
                    <ul style="margin-top: 15px; padding-left: 20px;">
                        <li><strong>0-20:</strong> Low Risk - Generally safe with standard security measures</li>
                        <li><strong>21-50:</strong> Medium Risk - Proceed with caution, verify legitimacy</li>
                        <li><strong>51-100:</strong> High Risk - Potentially dangerous, avoid interaction</li>
                    </ul>
                </div>

                <div class="about-section">
                    <div class="section-title">
                        🚀 Technology Stack
                    </div>
                    <p>PhishGuard is built using modern web technologies including JavaScript for real-time analysis, CSS3 for responsive design, and HTML5 for semantic structure. Our client-side processing ensures privacy while maintaining fast response times.</p>
                </div>
            </div>
        </div>

        <!-- Profile Page -->
        <div id="profile" class="page">
            <div class="profile-header">
                <div class="profile-avatar">👤</div>
                <h2>Security Scanner Profile</h2>
                <p>Your personal phishing protection dashboard</p>
            </div>

            <!-- Skeleton Loading for Profile Stats -->
            <div id="skeletonStats" class="skeleton-stats" style="display: none;">
                <div class="skeleton-stat-card">
                    <div class="skeleton skeleton-stat-number"></div>
                    <div class="skeleton skeleton-stat-label"></div>
                </div>
                <div class="skeleton-stat-card">
                    <div class="skeleton skeleton-stat-number"></div>
                    <div class="skeleton skeleton-stat-label"></div>
                </div>
                <div class="skeleton-stat-card">
                    <div class="skeleton skeleton-stat-number"></div>
                    <div class="skeleton skeleton-stat-label"></div>
                </div>
                <div class="skeleton-stat-card">
                    <div class="skeleton skeleton-stat-number"></div>
                    <div class="skeleton skeleton-stat-label"></div>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalScans">0</div>
                    <div class="stat-label">Total Scans</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="safeUrls">0</div>
                    <div class="stat-label">Safe URLs</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="threatsDetected">0</div>
                    <div class="stat-label">Threats Detected</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="averageRisk">0</div>
                    <div class="stat-label">Avg Risk Score</div>
                </div>
            </div>

            <!-- Skeleton Loading for History -->
            <div id="skeletonHistory" class="skeleton-history" style="display: none;">
                <div class="skeleton skeleton-history-title"></div>
                <div class="skeleton-history-item">
                    <div class="skeleton skeleton-history-url"></div>
                    <div class="skeleton skeleton-history-badge"></div>
                    <div class="skeleton skeleton-history-date"></div>
                </div>
                <div class="skeleton-history-item">
                    <div class="skeleton skeleton-history-url"></div>
                    <div class="skeleton skeleton-history-badge"></div>
                    <div class="skeleton skeleton-history-date"></div>
                </div>
                <div class="skeleton-history-item">
                    <div class="skeleton skeleton-history-url"></div>
                    <div class="skeleton skeleton-history-badge"></div>
                    <div class="skeleton skeleton-history-date"></div>
                </div>
                <div class="skeleton-history-item">
                    <div class="skeleton skeleton-history-url"></div>
                    <div class="skeleton skeleton-history-badge"></div>
                    <div class="skeleton skeleton-history-date"></div>
                </div>
            </div>

            <div class="history-section">
                <div class="section-title">
                    📝 Scan History
                </div>
                <div id="scanHistory">
                    <div class="empty-history">
                        No scans performed yet. Start by scanning a URL to build your security history.
                    </div>
                </div>
                <button class="clear-history-btn" onclick="clearHistory()" style="display: none;" id="clearHistoryBtn">
                    Clear History
                </button>
            </div>
        </div>
    </div>

    <script>
        let scanResults = {};
        let scanHistory = JSON.parse(localStorage.getItem('phishguard_history') || '[]');

        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Remove active class from all nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Add active class to clicked nav button
            event.target.classList.add('active');
            
            // Update profile stats if profile page is shown
            if (pageId === 'profile') {
                showProfileSkeleton();
                setTimeout(() => {
                    updateProfileStats();
                    displayScanHistory();
                    hideProfileSkeleton();
                }, 800);
            }
        }

        function showProfileSkeleton() {
            document.getElementById('skeletonStats').style.display = 'grid';
            document.getElementById('skeletonHistory').style.display = 'block';
            document.querySelector('.stats-grid').style.display = 'none';
            document.querySelector('.history-section').style.display = 'none';
        }

        function hideProfileSkeleton() {
            document.getElementById('skeletonStats').style.display = 'none';
            document.getElementById('skeletonHistory').style.display = 'none';
            document.querySelector('.stats-grid').style.display = 'grid';
            document.querySelector('.history-section').style.display = 'block';
        }

        function scanUrl() {
            const url = document.getElementById('urlInput').value.trim();
            const loading = document.getElementById('loading');
            const results = document.getElementById('results');
            const scanBtn = document.querySelector('.scan-btn');

            if (!url) {
                alert('Please enter a URL to scan');
                return;
            }

            // Validate URL format
            try {
                new URL(url);
            } catch (e) {
                alert('Please enter a valid URL (including http:// or https://)');
                return;
            }

            // Show loading
            loading.style.display = 'flex';
            results.style.display = 'none';
            document.getElementById('skeletonResults').style.display = 'none';
            scanBtn.disabled = true;
            scanBtn.textContent = 'Scanning...';

            // Show skeleton after 500ms
            setTimeout(() => {
                loading.style.display = 'none';
                document.getElementById('skeletonResults').style.display = 'block';
            }, 500);

            // Simulate scanning delay
            setTimeout(() => {
                const analysis = analyzeUrl(url);
                displayResults(analysis);
                
                // Save to history
                saveToHistory(analysis);
                
                document.getElementById('skeletonResults').style.display = 'none';
                results.style.display = 'block';
                scanBtn.disabled = false;
                scanBtn.textContent = 'Scan for Threats';
            }, 2500);
        }

        function analyzeUrl(url) {
            let riskScore = 0;
            const indicators = [];
            const urlObj = new URL(url);
            const domain = urlObj.hostname.toLowerCase();

            // Check for HTTPS
            if (urlObj.protocol !== 'https:') {
                riskScore += 20;
                indicators.push({
                    type: 'warning',
                    message: 'URL does not use HTTPS encryption'
                });
            } else {
                indicators.push({
                    type: 'safe',
                    message: 'HTTPS encryption detected'
                });
            }

            // Check for suspicious TLDs
            const suspiciousTlds = ['.tk', '.ml', '.ga', '.cf', '.pw', '.top', '.click', '.download'];
            const tld = domain.substring(domain.lastIndexOf('.'));
            if (suspiciousTlds.some(suspicious => tld.includes(suspicious))) {
                riskScore += 30;
                indicators.push({
                    type: 'danger',
                    message: `Suspicious top-level domain detected: ${tld}`
                });
            }

            // Check for URL shorteners
            const shorteners = ['bit.ly', 'tinyurl.com', 't.co', 'goo.gl', 'ow.ly', 'short.link'];
            if (shorteners.some(shortener => domain.includes(shortener))) {
                riskScore += 25;
                indicators.push({
                    type: 'warning',
                    message: 'URL shortener detected - destination unclear'
                });
            }

            // Check for suspicious keywords
            const suspiciousKeywords = ['secure', 'verify', 'update', 'confirm', 'urgent', 'suspended', 'limited', 'account-', 'login-', 'bank-', 'paypal-'];
            const fullUrl = url.toLowerCase();
            const foundKeywords = suspiciousKeywords.filter(keyword => fullUrl.includes(keyword));
            if (foundKeywords.length > 0) {
                riskScore += foundKeywords.length * 15;
                indicators.push({
                    type: 'warning',
                    message: `Suspicious keywords found: ${foundKeywords.join(', ')}`
                });
            }

            // Check for excessive subdomains
            const subdomains = domain.split('.').length - 2;
            if (subdomains > 2) {
                riskScore += 15;
                indicators.push({
                    type: 'warning',
                    message: 'Excessive subdomains detected'
                });
            }

            // Check for homograph attacks (basic)
            const homographChars = ['а', 'е', 'о', 'р', 'с', 'х', 'у']; // Cyrillic chars that look like Latin
            if (homographChars.some(char => domain.includes(char))) {
                riskScore += 40;
                indicators.push({
                    type: 'danger',
                    message: 'Potential homograph attack detected'
                });
            }

            // Check for IP addresses instead of domain names
            const ipPattern = /^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/;
            if (ipPattern.test(domain)) {
                riskScore += 35;
                indicators.push({
                    type: 'danger',
                    message: 'IP address used instead of domain name'
                });
            }

            // Check for suspicious URL patterns
            if (fullUrl.includes('data:') || fullUrl.includes('javascript:')) {
                riskScore += 50;
                indicators.push({
                    type: 'danger',
                    message: 'Potentially malicious URL scheme detected'
                });
            }

            // Check domain length
            if (domain.length > 50) {
                riskScore += 20;
                indicators.push({
                    type: 'warning',
                    message: 'Unusually long domain name'
                });
            }

            // Check for URL encoding
            if (fullUrl.includes('%') && (fullUrl.match(/%/g) || []).length > 3) {
                riskScore += 15;
                indicators.push({
                    type: 'warning',
                    message: 'Excessive URL encoding detected'
                });
            }

            // Add some positive indicators for legitimate sites
            const legitimatePatterns = ['google.com', 'microsoft.com', 'apple.com', 'amazon.com', 'facebook.com', 'twitter.com', 'linkedin.com', 'github.com'];
            if (legitimatePatterns.some(pattern => domain.includes(pattern))) {
                indicators.push({
                    type: 'safe',
                    message: 'Recognized legitimate domain'
                });
            }

            if (riskScore === 0 && indicators.filter(i => i.type === 'safe').length > 0) {
                indicators.push({
                    type: 'safe',
                    message: 'No suspicious patterns detected'
                });
            }

            return {
                riskScore: Math.min(riskScore, 100),
                indicators,
                url,
                timestamp: new Date()
            };
        }

        function displayResults(analysis) {
            const results = document.getElementById('results');
            const riskScore = document.getElementById('riskScore');
            const riskLevel = document.getElementById('riskLevel');
            const indicators = document.getElementById('indicators');

            // Determine risk level and styling
            let level, className;
            if (analysis.riskScore <= 20) {
                level = 'Low Risk';
                className = 'safe';
            } else if (analysis.riskScore <= 50) {
                level = 'Medium Risk';
                className = 'warning';
            } else {
                level = 'High Risk';
                className = 'danger';
            }

            // Update UI
            results.className = `results ${className}`;
            riskScore.textContent = `Risk Score: ${analysis.riskScore}/100`;
            riskLevel.textContent = level;

            // Display indicators
            indicators.innerHTML = '';
            analysis.indicators.forEach(indicator => {
                const div = document.createElement('div');
                div.className = 'indicator';
                
                const icon = document.createElement('div');
                icon.className = 'indicator-icon';
                
                switch (indicator.type) {
                    case 'safe':
                        icon.textContent = '✓';
                        icon.classList.add('safe-icon');
                        break;
                    case 'warning':
                        icon.textContent = '⚠';
                        icon.classList.add('warning-icon');
                        break;
                    case 'danger':
                        icon.textContent = '✗';
                        icon.classList.add('danger-icon');
                        break;
                }

                const message = document.createElement('div');
                message.textContent = indicator.message;

                div.appendChild(icon);
                div.appendChild(message);
                indicators.appendChild(div);
            });

            scanResults = analysis;
        }

        function saveToHistory(analysis) {
            const historyItem = {
                url: analysis.url,
                riskScore: analysis.riskScore,
                timestamp: analysis.timestamp,
                riskLevel: analysis.riskScore <= 20 ? 'low' : analysis.riskScore <= 50 ? 'medium' : 'high'
            };

            scanHistory.unshift(historyItem);
            
            // Keep only last 50 scans
            if (scanHistory.length > 50) {
                scanHistory = scanHistory.slice(0, 50);
            }

            localStorage.setItem('phishguard_history', JSON.stringify(scanHistory));
        }

        function updateProfileStats() {
            const totalScans = scanHistory.length;
            const safeUrls = scanHistory.filter(item => item.riskLevel === 'low').length;
            const threatsDetected = scanHistory.filter(item => item.riskLevel === 'high').length;
            const averageRisk = totalScans > 0 ? Math.round(scanHistory.reduce((sum, item) => sum + item.riskScore, 0) / totalScans) : 0;

            document.getElementById('totalScans').textContent = totalScans;
            document.getElementById('safeUrls').textContent = safeUrls;
            document.getElementById('threatsDetected').textContent = threatsDetected;
            document.getElementById('averageRisk').textContent = averageRisk;
        }

        function displayScanHistory() {
            const historyContainer = document.getElementById('scanHistory');
            const clearBtn = document.getElementById('clearHistoryBtn');

            if (scanHistory.length === 0) {
                historyContainer.innerHTML = '<div class="empty-history">No scans performed yet. Start by scanning a URL to build your security history.</div>';
                clearBtn.style.display = 'none';
                return;
            }

            clearBtn.style.display = 'block';
            historyContainer.innerHTML = '';

            scanHistory.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';

                const url = document.createElement('div');
                url.className = 'history-url';
                url.textContent = item.url;

                const riskBadge = document.createElement('div');
                riskBadge.className = `history-risk ${item.riskLevel}`;
                riskBadge.textContent = `${item.riskScore}/100`;

                const date = document.createElement('div');
                date.className = 'history-date';
                date.textContent = new Date(item.timestamp).toLocaleDateString();

                historyItem.appendChild(url);
                historyItem.appendChild(riskBadge);
                historyItem.appendChild(date);
                historyContainer.appendChild(historyItem);
            });
        }

        function clearHistory() {
            if (confirm('Are you sure you want to clear your scan history? This action cannot be undone.')) {
                scanHistory = [];
                localStorage.removeItem('phishguard_history');
                updateProfileStats();
                displayScanHistory();
            }
        }

        // Allow Enter key to trigger scan
        document.getElementById('urlInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                scanUrl();
            }
        });

        // Load profile stats on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateProfileStats();
        });
    </script>
</body>
</html>